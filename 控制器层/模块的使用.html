<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>模块的使用</title>
<script type="text/javascript" src="../syntax/scripts/shCore.js"></script>
<script type="text/javascript" src="../syntax/scripts/shBrushPhp.js"></script>
<script src="../treeview/lib/jquery.js" type="text/javascript"></script>
<script src="../treeview/lib/jquery.cookie.js" type="text/javascript"></script>
<script src="../treeview/jquery.treeview.js" type="text/javascript"></script>
<link type="text/css" rel="stylesheet" href="../style/base.css" />
<link type="text/css" rel="stylesheet" href="../syntax/styles/shCoreDefault.css"/>
<link rel="stylesheet" href="../treeview/jquery.treeview.css" />
<script type="text/javascript" src="../treeview/base.js"></script>
<script type="text/javascript">
$(document).ready(function(){
  
 $("#browser").treeview({
  persist: "location",
  collapsed: false,
  unique: true
 });
});
</script>
</head>
<body>
<pre><h2>模块介绍</h2>

  本手册中反复强调模块的使用。其实这正是本框架实用性所在。
  
<strong>1、什么是模块</strong>
         模块是PHP项目中多个控制器的组合，一般用来处理复杂繁多的同类业务。 
         一个网站，一般分成前台和后台。前台用户会有自己的一个会员中心，但其实后台和会员中心都可算是一个模块。在Ocara框架中，后台、会员中心都可
以建立一个模块。甚至，如果我们要自己开发一个微型论坛或博客，都可以建立一个模块，当然如果觉得他们实在太大，也可以建立一个新的应用。

<strong>2、学会使用模块</strong>      
      Ocara的控制层打破陈规，将控制层分为全局控制器和模块控制器，而模块本身包括多个子控制器。其实这个很符合现实。
      如下列表所示:
<table>
	<tr class="head">
		<td width="90">功能模块</td>
		<td width="300">包含功能</td>
		<td width="100">新建类型</td>
	</tr>
	<tr>
		<td>首页</td>
		<td>功能单一，即首页显示。</td>
		<td>全局控制器</td>
	</tr>
	<tr>
		<td>会员中心</td>
		<td>账号设置、资料修改、我的收藏和我的消息等</td>
		<td>模块控制器</td>
	</tr>
	<tr>
		<td>网站后台</td>
		<td>网站设置、导航设置、权限管理等</td>
		<td>模块控制器</td>
	</tr>
</table>
       <strong>说明：</strong>
               网站首页功能单一，所以一般新建成一个全局控制器。而网站的会员中心，由于它会有很多子功能，比如账号设置、资料修改、我的收藏和我的消息等，这
与模块的概念类似，因此可以建立会员中心模块，而这些子功能可以建立相应的子控制器来进行开发。而会员中心模块与首页又是同一级别的。
               再比如，网站的后台管理系统，也包括了网站设置、导航设置等等功能，所以也要建立成后台管理中心的模块来开发，而这些子功能要建立成子控制器。
               再比如，如果想开发一个小型论坛或博客，但是不愿意建立一个应用都可以新建一个模块。这样开发维护起来比较方便。

<h2>模块的使用</h2>

<strong>1、新建模块</strong>
  （1）模块对象类和目录结构
           在开发者中心新建一个模块后，在appalication/controller下面会存在同名的模块目录，其下包括一个模块类文件和多个子控制器目录。
 （2）模块类文件
           其中定义了这个模块控制器类，必须继承于根控制器。
 （3）控制器目录
           模块内的每个子控制器都要在当前模块目录中添加控制器的目录，其中的控制器类必须继承于当前模块控制器类。

<strong>2、实例</strong>
           假设网站后台管理，我们新建一个模块，命名为admin。
           其下面有一个item控制器，用于商品管理，并且有列表（list）、新建（create）、更新（update）和删除（delete）的操作。
           首先，该模块目录结构如下：
</pre>
  <ul id="browser" class="filetree">
		<li><span class="folder">Admin（admin模块目录）</span>
			<ul>
				<li><span class="file">AdminModule.php（admin模块类文件）</span></li>
				<li><span class="folder">Item（item控制器目录）</span>
				<ul>
					<li><span class="file">ItemController.php（item控制器类文件）</span></li>
					<li><span class="folder">Action（动作目录）</span>
                    <ul>
                        <li><span class="file">ListAction.php（list动作类文件）</span></li>
                        <li><span class="file">CreateAction.php（create动作类文件）</span></li>
                        <li><span class="file">UpdateAction.php（update动作类文件）</span></li>
                        <li><span class="file">DeleteAction.php（delete动作类文件）</span></li>
                    </ul>
                    </li>
				</ul>
				</li>
                <li><span class="folder">Order（order控制器目录）</span></li>
                <li><span class="folder">User（user控制器目录）</span></li>
			</ul>
		</li>
</ul>
<pre>

<strong>说明：</strong>
</pre>
<table class="hint" style="width:750px">
	<tr class="head">
		<td><h2>注：</h2>模块中类的继承思路：<span class=rvts8>模块本身继承于根控制器，子控制器继承于它，Action继承于这些子控制器。</span></td>
	</tr>
</table>
<pre>
  （1）模块控制器类文件（AdminModule.php）
           admin模块类文件。定义了AdminModule类。
           定义如下：
<pre class="brush: php;">class AdminModule extends Controller
{
    //模块的初始化函数
    protected function _module(){}
}
</pre>
           如果是Restful控制器，定义如下：
<pre class="brush: php;">class AdminModule extends RestController
{
    //模块的初始化函数
    protected function _module(){}
}
</pre>
  （2）模块的子控制器ItemController类文件（Item/ItemController.php）
           item控制器，定义了ItemController类。不同于全局控制器，这里要继承于AdminModule，而不是Controller，因
      为AdminModule已经继承了Controller。
           定义如下：
<pre class="brush: php;">class ItemController extends AdminModule
{
    //控制器的初始化函数
    protected function _control(){} 
}
</pre>
  （3）动作类文件
          动作类文件一般放在控制器目录的Action目录下面。
          例如Item/Action下面有ListAction.php、CreateAction.php、UpdateAction.php和DeleteAction.php。
          其中，ListAction.php是列表动作，定义了ListAction类，必须继承自ItemController。
          定义如下：
<pre class="brush: php;">class ListAction extends ItemController
{
    //动作的初始化函数
    protected function _action(){} 
    
    //新建表单
    protected function _form(){}
    
    //显示模板
    protected function _display(){}
    
    //表单提交后
    protected function _submit(){}
}
</pre>
          其他的动作类类似。

          如果是Restful控制器的Action，则只有_action()方法，定义如下：
<pre class="brush: php;">class ListAction extends ItemController
{
    //动作的初始化函数
    protected function _action()
    {
        $item = new \Model\Item();
        $data = $item->where(array('status' => 1))->getAll();
        return $data;
    }
}
</pre>

</pre>
</body></html>
