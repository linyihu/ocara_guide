<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Excel生成</title>
<script type="text/javascript" src="../syntax/scripts/shCore.js"></script>
<script type="text/javascript" src="../syntax/scripts/shBrushPhp.js"></script>
<link type="text/css" rel="stylesheet" href="../style/base.css" />
<link type="text/css" rel="stylesheet" href="../style/function.css" />
<link type="text/css" rel="stylesheet" href="../syntax/styles/shCoreDefault.css" />
<script type="text/javascript" src="../treeview/base.js"></script>
</head>

<body>
<pre><h1>Ocara\Service\Excel</h1>

<strong>一、插件介绍</strong>
       Excel文档生成插件，能够将指定的二维数组数据生成excel文档。
</pre>
<table class="hint">
	<tr class="head">
		<td><h2>特色：</h2>只需指定二维数组，即可生成行列式的excel文档。</td>
	</tr>
</table>
<pre><strong>二、方法函数介绍</strong>
</pre>
<div class="function">
<pre><strong>1、export(fileName, content[, charset]</strong>
    导出为文件，会弹出下载框。
    参数说明：
</pre>
<table>
	<tr class="head">
		<td width="90">名称</td>
		<td width="400">描述</td>
	</tr>
	<tr>
		<td>xlsName</td>
		<td>必需。导出的文件名称</td>
	</tr>
	<tr>
		<td>content</td>
		<td>必需。内容，为二维数组，每个子数组都是XML中的一行</td>
	</tr>
	<tr>
		<td>charset</td>
		<td>可选。文件编码，默认为gbk。如果设置为utf-8，也自动会保存为gbk格式。
              注：对于中英文，charset参数可以不用管，除非是其他国家语言编码，可以设置，但不保证会不会出现乱码</td>
	</tr>
</table>
<p>实例如下：</p>
<pre class="brush: php;">$excel->export(
     'test.xls',     
     array(
	    array('用户名称','用户ID'),
		array('小明', '12')
     )
); 
</pre>
<pre>
   解释： （1）如果该问该代码的页面，浏览器会自动以下载的方式导出excel文档。
              （2）共有两行，第一行为用户名称和用户ID两列（表头），第二行为小明和12两列。
              （3）注意第一个参数是文件名称，不是文件路径名称。

</pre>
<pre><strong>2、save(filePath, content[, charset, perm]</strong>
  直接保存为文件。
  参数说明： 
</pre>
<table>
	<tr class="head">
		<td width="90">名称</td>
		<td width="400">描述</td>
	</tr>
	<tr>
		<td>filePath</td>
		<td>必需。要保存的xml文件路径</td>
	</tr>
	<tr>
		<td>content</td>
		<td>同上</td>
	</tr>
	<tr>
		<td>charset</td>
		<td>同上</td>
	</tr>
	<tr>
		<td>perm</td>
		<td>可选。如果文件不存在新建文件时添加的可读写权限，默认为0755。</td>
	</tr>
</table>
<p>实例如下：</p>
<p>如果将上面的例子改成：
</p>
<pre class="brush: php;">$excel->save(
      ocPath('data', 'test.xls'), 
      array(
	     array('用户名称','用户ID'),
		 array('小明', '12'
     )
); 
</pre>
<pre>    解释：（1）如果执行该代码，则会保存为required/data/test.xls。
               （2）xml文档内容同上。
               （3）注意这里的第一个参数，是文件路径，使用了ocPath()函数。
</pre>
</div>
</body>
</html>
